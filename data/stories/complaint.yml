version: "3.1"


stories:

- story: complaint without reason and context - ask reason
  steps:
    - intent: complaint
    - action: action_intent_count
    - slot_was_set:
        - slot_complaint_count_key: 1
    - action: action_complaint
    - slot_was_set:
        - slot_complaint_key: 0
    - action: utter_apologize_reply
#    - action: collect_express_id_form
#    - active_loop: collect_express_id_form
#    - active_loop: null
    - action: utter_complaint_reply_6 # 问投诉原因

- story: complaint with context
  steps:
    - intent: complaint
    - action: action_intent_count
    - slot_was_set:
        - slot_complaint_count_key: 1
    - action: action_complaint
    - slot_was_set:
        - slot_complaint_key: 1
    - action: utter_apologize_reply    # 道歉
    - action: collect_express_id_form
    - active_loop: collect_express_id_form
    - active_loop: null
    - checkpoint: complaint_ckp

- story: complaint with reason - base
  steps:
    - or:
      - intent: complaint_logistics
      - intent: complaint_courier
      - intent: complaint_net_station
      - intent: complaint_did_not_sent_to_doorstep
      - intent: complaint_service
      - intent: complaint_courier_station
      - intent: complaint_customer_service
    - action: action_intent_count
    - slot_was_set:
        - slot_complaint_count_key: 1
    - action: utter_apologize_reply    # 道歉
    - action: collect_express_id_form
    - active_loop: collect_express_id_form
    - active_loop: null
    - checkpoint: complaint_ckp

- story: complaint with reason - has phone number
  steps:
    - checkpoint: complaint_ckp
    - action: action_set_slot_phone_key
    - slot_was_set:
        - slot_phone_key: 1
    - action: utter_complaint_reply_8

- story: complaint with reason - has no phone number
  steps:
    - checkpoint: complaint_ckp
    - action: action_set_slot_phone_key
    - slot_was_set:
        - slot_phone_key: 0
    - action: utter_complaint_reply_5    # 要电话


# 重复说要投诉
- story: complaint 2
  steps:
    - or:
        - intent: complaint_logistics
        - intent: complaint_courier
        - intent: complaint_net_station
        - intent: complaint_did_not_sent_to_doorstep
        - intent: complaint_service
        - intent: complaint_courier_station
        - intent: complaint_customer_service
    - action: action_intent_count
    # 此处的数字“100”并不是表示意图计数100次，而是表示大于“计数槽位最大值”的意思，假如“计数槽位最大值”为5，则大于等于6的数字都可以表示大于“计数槽位最大值”的意思，我们为了统一，指定了一个较大的数字100
    - slot_was_set:
        - slot_complaint_count_key: 100
    - action: action_set_slot_phone_key
    - slot_was_set:
        - slot_phone_key: 0
    - action: utter_complaint_reply_5    # 要电话

- story: complaint 2
  steps:
    - or:
        - intent: complaint_logistics
        - intent: complaint_courier
        - intent: complaint_net_station
        - intent: complaint_did_not_sent_to_doorstep
        - intent: complaint_service
        - intent: complaint_courier_station
        - intent: complaint_customer_service
    - action: action_intent_count
    # 此处的数字“100”并不是表示意图计数100次，而是表示大于“计数槽位最大值”的意思，假如“计数槽位最大值”为5，则大于等于6的数字都可以表示大于“计数槽位最大值”的意思，我们为了统一，指定了一个较大的数字100
    - slot_was_set:
        - slot_complaint_count_key: 100
    - action: action_set_slot_phone_key
    - slot_was_set:
        - slot_phone_key: 1
    - action: utter_apologize_reply      # 道歉
    - action: utter_complaint_reply_2    # 投诉安抚
